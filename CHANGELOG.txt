D2kEditor changelog

Version 1.4 (released 2020-XX-XX)
---------------------------------
Three major new features and changes:
1) Merged TileAtrEditor program into D2kEditor, so D2kEditor now has built-in Tile Attribute editor. 
   TileAtrEditor has been made obsolete program.
2) Significant improvements related to creating maps using custom tilesets. 
   Creating maps using custom tilesets is now much easier and faster.
3) Major changes in tileset configurations (tileset .ini files) related to new features and improvements.
   You will need to update your custom tileset .ini files to make them compatible with this version of program.

Other changes:
Added: Smooth spice rendering. Thin spice and thick spice is now drawn exactly how it appears in game.
Added: Select structures only mode. You can set the checkbox "Structures" next to "Select mode" radio button to
       third (grayed) state, which means select structures only. Useful for copying or moving base+units layout.
Added: Editor will load contents of custom TEXT.UIB file, if it is specified in mission .ini file.
       The "Test map" feature will automatically launch game with custom TEXT.UIB file.
Added: Preset Helper feature (accessible from "Open tileset" window). Here you can easily design a block preset and copy
       its code to tileset .ini file, or directly use that block in terrain editor.
Changed: In D2kEditor.ini file, the default tileset is not specified as tileset index, but as tileset name 
         (setting was renamed to "DefaultTilesetName"). 


Ad 1)
- Tile Attribute editor is now available from main menu under Tileset.
- You can edit the currently selected tileset for current map. Swithching tileset would change it for current map too. 
- You save map and tile attributes independently. When you save attributes, changes will apply immediately to your map.
- There is "Test in-game" feature (F8) that would save attributes and launch current map in game.

- You can now edit all 32 game attributes. Previously only 7 attributes (which were present in original TILEATRx.BIN files)
  were editable, but according to latest TILEATRx.BIN research, it was discovered that the other attributes are internal
  attributes used by game during gameplay for various purposes. You can achieve various effects using those additional
  attributes, for example place a real working concrete on a map.
- Editor attributes (special attributes used only by the editor to recognize which tile is sand, rock, dune tile etc.) are
  no longer part of TILEATRx.BIN files, because they conflicted with internal game attributes. You no longer need to 
  distribute two separate versions of TILEATRx.BIN files: one for game and one for editor.
- Editor attributes are stored inside tileset .ini file and editor saves them into .ini file automatically.
- TILEATRx.BIN files are no longer distributed with the program. The program loads these files from game folder.

- Added more flexible ways how you can filter tiles by attributes. Added "Filter tiles having any of attributes" mode,
  as well as "Filter tiles by rule" mode. Removed "Mark infantry-only" mode as this was just a specific case of a rule.
- "Filter tiles by rule" is the most advanced mode, where you can specify which attributes tiles need to have (either
  all of any of them) and which attributes tiles must not have (basically combination of all three previous filter modes).
  In this mode you can easily design your rule and then use it in your tileset .ini file.
- Added new view modes: "Draw minimap colors" and "Draw fill area groups" mode. These modes can help you design minimap
  color rules and fill area rules in your tileset .ini file, as you can easily and immediately see the result here.
- Added "Edit tile hint text" mode. Tile hint text is a text that displays in game when you move mouse cursor over that
  tile. In original tilesets this is used only on spice tiles.

Ad 2)
- In Terrain editing mode, there are now 4 common paint groups and 8 tileset-specific paint groups (12 paint groups total).
- The 4 common pain groups are reserved for Thin Spice, Thick Spice, Concrete and Void. The latter two are not commonly
  used in maps, but are potentially usable for new designs, or in custom tilesets. For example concrete can be used for
  decoration (in original tilesets it cannot be built on it), but it can be made buildable using specific tile attributes 
  and used as real concrete in for example Dune 2 tileset. The Void could be used to make non-rectangle maps, or it is 
  useful for indoors tilesets (i.e. Heighliner).
- The 8 paint groups can be used for any terrain types. The original tilesets use no more tha 3 types (Sand/Rock/Dunes) 
  or 4 types (Ice), however, in custom tilesets you can use all 8.
- Improved "Auto-Smooth edges" feature (Shift-Click) and made it more flexible and configurable for custom tilesets.
  You can take advantage of this feaure for any terrain type in custom tilesets, it is not strictly limited for
  Rock and Dunes edge in original tilesets.
- Added "Restrict painting" feature, which will let you paint specific tiles only on specific terrain type (i.e. spice and
  dunes can be painted only on sand, concrete can be painted only on rock). Previously there was spice restriction rule, 
  but it was made generally usable for any paint type. This can be turned off in Settings menu.
- Added support for block presets with "blank" tiles. You can now have presets of any shape (not strictly rectangle shape).

Ad 3)
- Changed the way how rules (minimap color rules, fill area rules) are specified. Rules are now specified in this form:
  $attrubites_tile_must_have
  -OR-
  $attrubites_tile_must_have;$attrubites_tile_must_not_have
  If $attrubites_tile_must_have is negative, it means tile must have ANY of specified attributes.
  To design a rule, you can simply use specific filter on Tile Attributes editor and just copy the rule specification.
- You can specify up to 12 paint groups in [Paint_Tile_Groups] section.
  Groups A,B,C,D are reserved for thin spice, thick spice, concrete and void.
  Groups 1-8 are tileset-specific groups you can use for any terrain type.
- The list of tiles used by a paint group is no longer specified by marking those tiles by editor attributes 
  (Paint type 1-4), but directly as part of paint group specification ("GroupX.paint_tiles"). You can specify same tile
  number multiple times, which would increase probability of that tile being randomly selected.
- The block presets used by "Auto-smooth edges" feature (Shift-click) are specified with "GroupX.smooth_preset_group" and
  "Group2.smooth_presets" properties. The presets are specified as list of keys on keyboard. There are two different modes
  of "Auto-smooth edges" feature:
  1) 20 presets mode: used by original Dune2000 tilesets. Uses 12 1x1 blocks and 8 2x2 curved blocks.
  2) 12 presets mode: uses only 1x1 blocks (4 straight blocks, 4 corners, 4 inner turns).
- Added paint group restruction rule, which can be specified as "GroupX.restriction_rule"
- The [Spice_Settings] section was completely removed. The spice minimap colors are now specified as additional minimap 
  color rules. The thin/thick spice name, tile and restriction rule is specified as part of paint group A and B.
- Spice is now also specified as separate fill area group.
- Changed way how custom block presets (= blocks consisting of tiles not continuously arranged in tileset) are specified.
  You no longer need to specify them under separate [Custom_Blocks] section, but directly under [Block_Preset_Group_X]
  section along with standard blocks. To distinguish custom blocks, the width and height must be negative.
  You can utilize "Preset Helper" feature to easily design a block preset, and then copy its code and paste to .ini file.
- Normal block presets are represented as "width.height.tileset_x.tileset.y", but you can newly specify them also in
  simplified form "width.height.tile_index"


Version 1.3 (released 2019-02-27)
---------------------------------
Fixed: Size preset buttons in Tileset window were off by one position
Added: Find object feature
Changed: Some options (i.e. Show grid) are now toggle buttons below minimap instead of Settings menu items
Removed: Draw concrete option (now is always on)
Added: Play Sound event: now provides dropdown list of sound names (loaded from "samples.uib")
Added: Play Music event: now provides dropdown list of music names (list of existing .AUD files in "Data\Music" folder)
Fixed: Set Attack Building Rate event: value is named "Arrack rate" instead of "Unknown" 
Fixed: Casualties condition: "Flags?" value renamed to "Proportion" and changed to floating-point number type
Added: When temporary "TESTMAP.MAP" file is saved, the map name in ini file is renamed to "TESTMAP" 
       in order to avoid duplicate entry in mission launcher
Added: Open recent files feature
Fixed: Editing marker (i.e. building marker, current block) not showing when Mission settings or Events/Conditions 
       window is open and is on background or minimized
Added: "MissionsPath" setting in .ini file. It can be changed in case game loads maps/mission files from different location
Fixed: The UI components now should not be messed up on systems where scaling is set to different value than 100%
Added: Highlighting events having selected condition feature
Fixed: Program now checks, if window would appear off-screen (i.e. previously opened on second monitor which is now
       unplugged) and resets its position
Changed: Program now automatically loads all all .ini files placed into "tilesets" folder, instead of loading tileset list
         from "config\tilesets.ini". All tileset .ini files must now contain name of attributes file.
Added: Loading tileset images directly from game's internal .R8 and .r16 files
Removed: Editor is no longer distributed with tileset .bmp files
Fixed: Improved auto-detection of game folder, detection of missions stored under "Data\Missions" folder
Changed: Mission settings window should fit 1024 pixels wide resolution
Added: Tileset name and Attributes fields on Mission settings window
Added: Custom Text.uib field on Mission settings window (mission .ini file)
Added: Conditions can be organized by moving up and down (like events)
Added: Grid color setting and several more settings
Added: AI manual (written by Cm_blast)
Added: AI templates (created by Cm_blast)
Added: Information message upon start when starting program for the first time
Fixed: Some errors on BLOXBAT tileset configuration, added missing tiles to new "Sand stains" preset group
Added: README.txt file


Version 1.2 (released 2015-11-16)
---------------------------------
Fixed: "Cannot focus a disabled or invisible window" error
Fixed: Tile with index 0 (left-top-most sand tile) is no longer used for painting a sand
Added: You can "cut" (erase) the selected area if you hold shift while selecting the area.
Added: "Mark buildable tiles" option
Changed: Structure list was divided into separate building and unit lists
Added: You can now place any building or unit for any side. In order to use this feature
       in game, you must copy the file config/TILEDATA.BIN into your Dune2000/Data/bin folder. 
Added: Structures and Misc. objects are now externally configured (structures.ini, misc_objects.ini).
Added: You can now place continuous wall by moving the mouse while holding left button
Changed: Units are now grouped by unit type in the event table in "Contents" column
Added: Event notes are shown in the event table. Event table Columns are now resizable.
Added: Map statistics
Added: Support for "Custom blocks" - blocks which are not stored continuously in the tileset.
       Adjusted tileset configurations accordingly.
Added: Confirmation dialog when closing the editor. It can be turned off in D2kEditor.ini.

Improved the rendering engine and the editing interface:
- Optimized map rendering: it should be faster and consume less CPU
- Concrete is properly drawn under buildings, added "Draw concrete" option
- Added Building marker and brush marker


Version 1.1 (released 2015-10-16)
---------------------------------
Fixed: Auto-smooth rock/dunes edge feature did not work properly on non-square maps
Fixed: Tried to fix the status bar cut-off (status bar is now okay hopefully)
Fixed: When a map is shifted, event positions were not shifted
Fixed: When saving Briefing, newlines were erroneously inserted where a line was only visually broken
Fixed: Error message when opening a map from commandline
Added: Support for new event types added in FunkyFr3sh's Dune 2000 patch (Leave, Play Sound...)
Added: Key shortcuts for selecting event/condition type
Added: "Diff mode" in AI settings - only values which are different from default values are shown
Added: Several minor and cosmetic improvements

Remade terrain editing GUI and added possibility to configure block presets and other things for each tileset.
- You can paint spice in Terrain mode instead of Structures mode.
- Added new "Block preset selection" window where you can see all presets for selected group in the same order
  as how you select them with the keyboard. It can be displayed by clicking on current block, double-clicking on 
  block-preset group or pressing space two times. Use right-click to change to next block variant, middle-click to
  display keyboard keys and Tab to change variant for all presets.
  If you set "HidePresetWindow" setting in D2kEditor.ini to 0, the window will stay open after selecting a preset.
- Added presets also all for tileset-specific blocks
- Each tileset has its own .ini file. There you can configure minimap colors, names of paint and block-preset groups,
  block presets and other things. This way you can easily add custom tilesets and tailor the editor for using them.



Version 1.0 (released 2015-07-10)
---------------------------------
Added: "Smooth rock/dunes edge" feature:
       - Select "Paint Rock" or "Paint Dunes", and then Shift-Click somewhere onto the edge of rock or dunes area. 
         All the edge will become smoothed: the rock/dunes tiles neighbouring with sand are turned into edge tiles.
       - The smoothing process starts in the point you click on and continues in the counterclockwise direction.
       - The process ends when any obstacle is encountered. That means you need to click onto appropriate tile.
       - The smoothed edge sometimes won't look as good as if you made it manually.
Added: New editor-specific tileset attributes are used in order to make the "Smooth edges" feature work properly.
       These attributes are also used in "Fill area" feature. Modified TILEATRx.BIN files are distributed with the editor.
Added: Ice has its own color on minimap
Added: You can drag .map files into editor window to open them
Added: Copy&Paste feature: You can copy and transfer selected block between two instances of the editor
Added: New key shortcuts for spice (ctrl+Q, ctrl+W) and selecting player (Num 0 - Num 6) in Structures mode
Added: Map name is shown in window title
Added: Program now stores persistent settings in D2kEditor.ini file:
       - Editor window position and size is preserved when you close and open editor again.
       - Game path is is stored in ini file and can be edited.
       - Several default values are stored in ini file and can be edited.
       - Several preferences are stored in ini file and can be edited. More preferences will be possibly added in future.
Added: Tileset window is vertically resizable

Complete Mission (.mis file) editor was implemented. Program was renamed to "Dune 2000 Map and Mission Editor".
- Two new windows were added: "Mission settings" and "Events and conditions"
- Added support for map .ini file features (supported by FunkyFr3sh's Dune 2000 Patch and Mission launcher)
- Event editor provides complete tabular overview of events, with detailed information about events and their conditions.
- Events can be easily manipulated (move up/down, insert event, delete event, duplicate event etc.)
- "Create common events" feature: You can quickly create events like Harvester replacement, or add flag to run the event only once.
- Added event and condition notes (stored in map .ini file). If you set note to a Flag condition it is displayed like Flag name.
- You can directly edit Message text in event editor (if map .ini is used)
- You can easily set reinforcement (and other event) position by using "Go to map" and then clicking into map. You can also 
  drag event markers in map editor to move the events. Double-click on event marker to show the event in Event editor.
- You can easily edit all AI properties (which are known). The list of AI properties (and some other configuration) is stored
  externally and can be modified.
- Added "Mark defence areas" feature (they are stored within AI and known uses are only in A4V1 and H4V1 Fremen bases).



Alpha 0.6 (released 2015-05-30)
-------------------------------
Added: "Mark tiles" option also to Tileset window. Buildable tiles are marked there too.
Added: "Edit" menu with Undo and Redo options
Added: Press TAB key to switch between Structures and Terrain mode
Added: "Show unknown specials" feature
Added: If more events (Reinforcements etc) are placed in one tile, additional markers are dwawn next to that tile
Added: If mouse cursor is moved over Reinforcement or Spawn marker, list of units is displayed. Works in Structures mode.
Changed: Minimap is updated after you finish painting of sand/rock/dunes/spice, because rendering was very slow.
Added: "Fill area" feature: works with sand, rock, dunes and spice.
       - You need to double-click into a tile inside area you want to fill.
       - Area consists of connected tiles of same "type". There are 4 types: Clean sand, Dunes, Spice and anything other.
Added: Made block selection from tileset much easier. You no more need to select predefined block size and then click to tileset,
       but you can select any block simply with mouse. (You can still use presets if you want.)
Fixed: When you resize map, the new empty space is filled with random sand
Added: "Test map" feature: you can now launch and test your map directly from the editor!
       Requirements:
       - You need to have modified version of Dune2000.exe, which supports mission launching.
         (It is distributed along with Mission launcher)
       - Dune2000.exe must be in parent directory of the directory where the map is saved
       - Counterpart .mis file must exist and there must be no map errors (missing Worm Spawners etc.)
       How it works:
       - Added "Test" menu with two options "Quick launch" and "Launch with settings"
       - "Quick launch" simply starts game with last settings
       - "Launch with settings" opens a window where you can set Difficulty, Mission number, Side you want to play as etc.
       - Mission number and Side is detected from map name's last 4 characters (like A4V1 - A for Side, 4 for mission).
       - For map names not having this name pattern you need to set them manually.
       - Before launching, map is saved into temporary file (TESTMAP.map) which is actually launched. 
       - Original map is not saved. Don't forget to save!
Added: "Create empty .mis file" feature: Creates .mis file with default settings, no events, no AI. Useful when creating new map. 
         


Aplha 0.5 (released 2015-05-02)
-------------------------------
Fixed: Map image is saved properly
Added: Program accepts map filename as parameter
Changed: New icon (by dato 2000)

Major terrain editing improvements:
- Selected tile block is drawn under mouse cursor when editing a map
- You can Drag&Scroll map while holding right button in terrain editing mode
- Fully functional Undo&Redo feature: you can undo/redo as many steps as you want (use Ctrl+Z, Ctrl+Y).
- Added "Select&Copy" feature: you can select area on a map with mouse (press left button and drag) 
  and then place that area somewhere in map or even in different map. You can choose to select
  area with or without structures (structures are not drawn on the selected block) 
- Added "Block key-presets" feature: This will let you draw cliffs and borders MUCH FASTER!!!
  Each key on keyboard (1, 2, 3, 4, Q, W, E, R, T, ect) has its block preset. Instead of selecting tile block 
  from tileset or from a list (like in Shai-Hulud editor), you just simply press key on keyboard and select 
  tile which you want. The layout of keys and their tiles is logical and intuitive (hopefully).
  Press key multiple times if there are more "versions" of the block.
  There are four preset groups: rock-sand cliff, sand-sand cliff, rock border, dunes border.
- Keyboard shortcuts were changed and there are several new.
  All old letters/numbers shortcurs now work with Shift (Shift+R for selecting Rock, Shift+2 for 2x2 block etc)
  New shortcuts: Shift+C for Select&Copy mode, F1-F4 for selecting key-preset group 
  Num2, Num4, Num6, Num8 for moving block on map (useful when you want to move it beyond upper or left map border)
  "`" (the key under Esc) for quick select of Sand/Rock/Dunes according to current key-preset group
  

Alpha 0.4 (released 2015-04-28)
-------------------------------
Fixed: All map is now properly rendered on high resolutions. Resolution is now unlimited.
Fixed: Added missing support for finite spice bloom types.
Fixed: Stealth Fremen are now shown on map.
Added: "Use allocation indexes" feature: the structures are rendered as belonging to in-game house. 
       Indexes are loaded from .mis file. Values higher than 6 default to 0.
Added: "Mark impassable tiles" feature: you can now see which tiles are impassable or infantry-only.
Added: "Show event markers" feature: you can now see positions of reinforcements and other events on map.
       Supported events are: Reinforcement(R), Harvester replacement(H), Unit spawn(S), Unit in tile(T),
       Reveal map(M). Also event number is shown.
       Markers are loaded from .mis file and cannot be edited, use Reload map after editing mis file.
Added: Number of Worm spawners, Player starts and Spice blooms is shown.
Added: Warning when trying to save map without Worm spawners or wrong number of Player starts.
Added: Value of produced and needed power is shown along with power percentage.
Added: "Save map image" feature (to .bmp file, Delphi 7 has not native support for png)
Added: Map can be scrolled with mouse wheel
Changed: Single click (instead of double click) for selecting tile block from tileset.
Changed: Other minor improvements to user interface.


Alpha 0.3 (released 2011-08-10)
-------------------------------
Added: Terrain editing support (you can place a tile block of chosen size, you select the block from
       tileset or copy from map, sand/rock/dunes paint support)
Added: You can see terrain on minimap (TILEATR files used for this purpose)
Added: "Change structures owner" feature
Added: Simple Help and About
Added: Now distributed with tileset files


Alpha 0.2 (released 2011-08-04)
-------------------------------
Added: You can scroll map also with keyboard arrows and by clicking into minimap. Scrolling should be smoother now
Added: Carryall and worm spawn/spice bloom sprites
Added: Auto detecting tileset from .mis file
Added: Key shortcuts, Reload map, direct Save map
Added: "Resize map" and "Shift map" feature
Added: Power percentage calculator (not working properly, I need to find correct power calculation formula)


Alpha 0.1 (released 2011-07-29)
-------------------------------
Open map, Save map, Minimap, Select tileset, place or remove buildings or units for 7 players, 
edit spice and pawn points, Show grid      